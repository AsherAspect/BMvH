import os

from dotenv import load_dotenv

import sys
sys.path.append(os.path.abspath(os.path.join(os.path.dirname(__file__), '..', 'src')))
# from handling_stabu.stabu_helpers import build_stabu_from_csv

# Testoutput
outp = {'22': {'22.00': {'reasoning': 'Deze offerte is algemeen gericht op metselwerk, inclusief alle verbanden en werkzaamheden rondom nieuwbouw metselwerk, isolatie, stelwerk en voegwerk, zonder specifieke uitsluitingen. Beschrijving in de offerte tekstdelen en prijsopgaven bevestigt het algemene karakter.', 'met': 2, 'totaal_prijs': 0, 'totaal_eenheid': 1, 'eenheid': 'proj', 'prijs_per_eenheid': 0, 'prijs_per_eenheid_onderbouwing': 'Algemene offerte-bepaling voor het metselwerk. Prijzen zijn opgenomen per onderdeel, geen totaalprijs voor projectniveau opgegeven.', 'context': 'De offerte betreft alle arbeid voor metsel- en bijbehorende werkzaamheden, gebaseerd op bestek en tekeningen voor 50 huurappartementen. Alle prijzen exclusief BTW. Situaties, uitgangspunten en voorwaarden zijn puntsgewijs omschreven in het document. Alleen arbeid, materialen door opdrachtgever, tenzij anders overeengekomen.'}, '22.11': {'reasoning': 'Er wordt uitgebreid beschreven wat onder metselwerkzaamheden valt en wat niet, alsmede toelichting rondom voorwaarden die aan het werk worden gesteld (werksituatie, levering, geldigheid), en hiÃ«rarchie ten aanzien van offerte/bestek. Dit valt onder functionele omschrijvingen.', 'met': 2, 'totaal_prijs': 0, 'totaal_eenheid': 1, 'eenheid': 'proj', 'prijs_per_eenheid': 0, 'prijs_per_eenheid_onderbouwing': 'Functionele beschrijving en omschrijving vallen niet onder een afzonderlijke prijs; kosten zijn vervat in de andere postprijzen.', 'context': 'Functie- en uitvoeringsomschrijvingen, uitsluitingen van werkzaamheden, voorwaarden voor opslag, levering, maatvoering en overige randvoorwaarden betrokken op het metselwerk.'}, '22.13': {'reasoning': 'Er wordt gesteld dat kwaliteits- en veiligheidsrapporten periodiek worden verstrekt en gelegenheid wordt geboden tot audits/inspecties ISO9001/VCA/Komo. Dit duidt op regelmatige controles, rapportages, metingen, en keuring.', 'met': 2, 'totaal_prijs': 1500, 'totaal_eenheid': 1, 'eenheid': 'proj', 'prijs_per_eenheid': 1500, 'prijs_per_eenheid_onderbouwing': 'Expliet gespecificeerd in de offerte: Kwaliteit/Veiligheid rapporten 2-wekelijks conform KOMO/Veiligheidladder 1.500,00 per project.', 'context': 'Dit betreft het periodiek opmaken van kwaliteits- en veiligheidsrapporten voor het project, inclusief het faciliteren van keuringen en audits conform de eisen van KOMO, ISO9001 en VCA*.'}, '22.31': {'reasoning': 'Het hoofdonderdeel is traditioneel metselwerk van gevelsteen (baksteen, handvorm/vormbak waalformaat met mortel), conform subcode 22.31.', 'met': 2, 'totaal_prijs': 0, 'totaal_eenheid': 1, 'eenheid': 'proj', 'prijs_per_eenheid': 0, 'prijs_per_eenheid_onderbouwing': 'Prijs per eenheid (m2) ontbreekt, aangezien de post alleen als bedrag per 0/00 is vermeld (840 euro per promille), zonder totaalhoeveelheid.', 'context': 'Metselwerk ter plaatse van de gevels voor 50 appartementen, bestaat uit arbeid voor het verwerken van handvorm/vormbak gevelsteen, waalformaat, normaal zuigend, inclusief alle standaard werkzaamheden uitgelegd onder de metselwerk-scope.'}, '22.60': {'reasoning': 'Er worden stootvoegroosters, inmetselen van ventilatiekokers, HWA, spuwer, elektrische punten, etc. genoemd die betrekking hebben op voorzieningen in metselwerk.', 'met': 2, 'totaal_prijs': 0, 'totaal_eenheid': 0, 'eenheid': 'st', 'prijs_per_eenheid': 0, 'prijs_per_eenheid_onderbouwing': 'Enkele voorzieningen staan apart geprijsd (zie 22.85), maar overige voorzieningen zijn niet apart als totaalpost geprijsd.', 'context': 'Bevat voorzieningen in gevelmetselwerk, zoals het inmetselen van voorzieningen (doorvoeren t.b.v. water, HWA, elektra etc.), echter geen apart totaalbedrag.'}, '22.72': {'reasoning': "Er is een duidelijke post 'Voegwerk, doorstrijken 5-10 mm verdiept (pointmasteren)', expliciet opgenomen in de offerte.", 'met': 2, 'totaal_prijs': 0, 'totaal_eenheid': 0, 'eenheid': 'm2', 'prijs_per_eenheid': 17.25, 'prijs_per_eenheid_onderbouwing': 'Uit de offerte: Voegwerk, doorstrijken 5 - 10 mm verdiept (pointmasteren) EUR 17,25 per m2. Geen totaal aantal m2 opgegeven.', 'context': 'Dit betreft het verdiept aanbrengen van voegwerk met de pointmaster techniek voor alle gevels waar metselwerk gespecificeerd is. Diepte en techniek zijn vastgelegd, andere voegtypes uitgesloten. Enkel arbeid.'}, '22.81': {'reasoning': 'Toeslag metselwerk, murfor aanbrengen betreft doorlopende wapening van metselwerk, vandaar onder deze stabu-code relevant.', 'met': 2, 'totaal_prijs': 0, 'totaal_eenheid': 0, 'eenheid': 'm1', 'prijs_per_eenheid': 3.75, 'prijs_per_eenheid_onderbouwing': 'Direct uit de offerte: Toeslag metselwerk, murfor aanbrengen EUR 3,75 per m1. Geen totaal aantal meters opgegeven.', 'context': 'Arbeid voor het aanbrengen van murfor-wapening in metselwerk, ter plaatse van gevel en volgens specificatie. Materiaal door opdrachtgever, slechts arbeid inbegrepen.'}, '22.82': {'reasoning': 'Er worden beton- en spekbanden, ankers en lateien genoemd (ankers boren/parapluplug, lateien beton/staal, geveldragers, etc.), wat verankeringen en opvangconstructies betreft.', 'met': 2, 'totaal_prijs': 0, 'totaal_eenheid': 0, 'eenheid': 'm1', 'prijs_per_eenheid': 22.5, 'prijs_per_eenheid_onderbouwing': 'Offerte vermeldt: Lateien, beton/staal, handzaam max 25kg t.b.v. metselwerk 22,50 per m1. Ook betonband/spekband voor zelfde prijs per m1. Geen totaal-lengte opgegeven.', 'context': 'Arbeid voor het plaatsen van verankeringen, opvangconstructies zoals lateien (beton/staal) en spekbanden. Materiaal door opdrachtgever, alleen arbeid inbegrepen en tot gewicht 25kg per stuk.'}, '22.83': {'reasoning': 'Diverse soorten isolatie, inclusief snijden en verwerken, worden expliciet opgenomen met eenheidsprijzen.', 'met': 2, 'totaal_prijs': 0, 'totaal_eenheid': 0, 'eenheid': 'm2', 'prijs_per_eenheid': 8.8, 'prijs_per_eenheid_onderbouwing': 'Uit de offerte: Isolatie, zacht t/m 140 mm EUR 8,80 per m2, overige isolatie is per meter maar hoofdpost betreft m2.', 'context': 'Arbeid voor het aanbrengen van zachte isolatie t/m 140mm dik in metselwerk. Incl. stroken schuin snijden en stroken tussen bouwmuren per m1, maar hoofdprijs per m2. Alleen arbeid, geen isolatiemateriaal.'}, '22.84': {'reasoning': 'Toeslag metselwerk, smetfolie/folie op maaiveldniveau t.b.v. optrekkend vocht wordt expliciet in de offerte benoemd als vochtkering.', 'met': 2, 'totaal_prijs': 0, 'totaal_eenheid': 0, 'eenheid': 'm1', 'prijs_per_eenheid': 4.4, 'prijs_per_eenheid_onderbouwing': 'Toeslag metselwerk, smetfolie/folie op maaiveldniveau t.b.v. optrekkend vocht EUR 4,40 per m1. Geen totaal aantal meters opgegeven.', 'context': 'Toeslag op arbeid ten behoeve van het aanbrengen van smetfolie of folie onder het metselwerk bij het maaiveld, als optrekkende vochtkering.'}, '22.85': {'reasoning': 'Er zijn posten voor het inmetselen van ventilatiekokers en stootvoegroosters, wat aansluit bij kanaaltoebehoren en ventilatievoorzieningen.', 'met': 2, 'totaal_prijs': 0, 'totaal_eenheid': 0, 'eenheid': 'st', 'prijs_per_eenheid': 16.5, 'prijs_per_eenheid_onderbouwing': 'Toeslag metselwerk, inmetselen ventilatiekoker, HWA, spuwer, electrische punten EUR 16,50 per stuks, stootvoegroosters EUR 0,95 per stuks; hoofdpost is inmetselen ventilatiekoker o.a.', 'context': 'Inmetselen van ventilatiekokers, HWA, spuwer, electrapunt als afzonderlijke arbeids-post verstand als kanaaltoebehoren of ventilatievoorzieningen in het metselwerk. Alleen arbeid, geen materiaal.'}}}
for cat, val in outp.items():
    print(cat)
    for crit, rest in val.items():
        print(f"     - {crit}")
        for point, details in rest.items():
            print(f"          - {point}: {details}")